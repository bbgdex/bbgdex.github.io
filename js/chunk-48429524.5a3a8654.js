(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48429524"],{"2db2":function(t,e,s){t.exports=s.p+"img/bbglogo.0ebf23de.svg"},4995:function(t,e,s){t.exports=s.p+"img/downarrow.3dc9d2e1.svg"},"4f3b":function(t,e,s){"use strict";s("99f5")},"870d":function(t,e,s){t.exports=s.p+"img/usdtlogo.bb5274f9.svg"},"99f5":function(t,e,s){},bc38:function(t,e,s){t.exports=s.p+"img/wallet.da5c6071.svg"},e981:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"destroy-mining"},[e("span",[t._v(t._s(t.$t("destroyMining.text1")))]),e("div",{staticClass:"container"},[e("div",{staticClass:"destroy-amount"},[e("div",{staticClass:"title"},[e("img",{attrs:{src:s("bc38")}}),e("span",[t._v(t._s(t.balances[t.TokenName].toFixed(4)))]),e("span",[t._v(t._s(t.TokenName))])]),e("div",{staticClass:"input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],attrs:{type:"number",placeholder:t.$t("destroyMining.text2")},domProps:{value:t.amount},on:{input:[function(e){e.target.composing||(t.amount=e.target.value)},t.input]}}),e("div",{staticClass:"SelectToken",on:{click:function(e){t.showSelectToken=!t.showSelectToken}}},[e("img",{staticClass:"logo",attrs:{src:t.tokenLogo}}),e("span",[t._v(t._s(t.TokenName))]),e("img",{attrs:{src:s("4995")}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSelectToken,expression:"showSelectToken"}],staticClass:"options"},[e("span",{on:{click:function(e){return t.SelectToken("USDT")}}},[t._v("USDT")]),e("i"),e("span",{on:{click:function(e){return t.SelectToken("BBG")}}},[t._v("BBG")])])])]),e("span",[t._v(t._s(t.$t("destroyMining.text3"))),e("span",[t._v(t._s(t.power))])]),e("div",{staticClass:"toAddress"},[e("div",{staticClass:"select-account"},[e("span",[t._v(t._s(t.$t("destroyMining.text15")))]),e("span",{on:{click:function(e){t.showSelect=!t.showSelect}}},[t._v(t._s(t.receiver)+" "),e("van-icon",{attrs:{name:"arrow-down"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSelect,expression:"showSelect"}],staticClass:"options"},[e("span",{on:{click:function(e){return t.selectReceiver("他人")}}},[t._v(t._s(t.$t("destroyMining.text4")))]),e("i"),e("span",{on:{click:function(e){return t.selectReceiver("自己")}}},[t._v(t._s(t.$t("destroyMining.text5")))])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSelect,expression:"showSelect"}],staticClass:"overlay",on:{click:function(e){t.showSelect=!1}}})]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.toAddress,expression:"toAddress"}],attrs:{type:"text",readonly:t.isReadyonly,placeholder:"他人"==t.receiver?t.$t("destroyMining.text17"):""},domProps:{value:t.toAddress},on:{input:function(e){e.target.composing||(t.toAddress=e.target.value)}}})]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:"none"===t.tradeState,expression:"tradeState === 'none'"}],staticClass:"double-button",on:{click:t.burnBHTCastingForce}},[t._v(t._s(t.btnText)+" ")]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:"none"!==t.tradeState,expression:"tradeState !== 'none'"}],staticClass:"double-button",attrs:{loading:"","loading-text":t.btnText}})],1)])},i=[],o=(s("e7e5"),s("d399")),a=(s("c3a6"),s("ad06")),r=(s("66b9"),s("b650"));const d={USDT:s("870d"),BBG:s("2db2")};var c={components:{[r["a"].name]:r["a"],[a["a"].name]:a["a"]},data(){return{amount:"",toAddress:"",receiver:this.$t("destroyMining.text5"),TokenName:"BBG",showSelect:!1,showSelectToken:!1,isReadyonly:!0,power:0,inputing:!1,tradeState:"none",prevEnter:"",balances:{BBG:"0",USDT:"0"},allowances:{BBG:"0".toBN(),USDT:"0".toBN()}}},computed:{btnText(){return"approving"===this.tradeState?this.$t("destroyMining.text6"):"trading"===this.tradeState?this.$t("destroyMining.text7"):this.allowances[this.TokenName].lt(this.amount)?this.$t("destroyMining.text8"):this.$t("destroyMining.text9")},tokenAddress(){return this.$contracts[this.TokenName+"Token"].options.address},tokenLogo(){return d[this.TokenName]}},created(){this.$contracts&&(this.init(),this.toAddress=this.$address)},methods:{SelectToken(t){this.showSelectToken=!1,this.TokenName=t,this.init()},selectReceiver(t){this.receiver="自己"===t?this.$t("destroyMining.text5"):this.$t("destroyMining.text4"),this.showSelect=!1,this.isReadyonly="自己"===t,this.toAddress="自己"===t?this.$address:""},input(){if(this.inputing)return!1;if(this.amount<=0)return this.power=0,this.inputing=!1,!1;this.inputing=!0,this.prevEnter=this.amount;const t=setTimeout(()=>{if(this.amount<=0)return this.power=0,this.inputing=!1,clearTimeout(t),!1;this.$contracts.Govern.methods.getBurnForce(this.tokenAddress,this.amount.toWei()).call({from:this.$address},(e,s)=>{e||(this.power=s[0].fromWei().toFixed(0),this.inputing=!1,clearTimeout(t),this.amount!==this.prevEnter&&this.input())})},1e3)},approve(){this.$contracts[this.TokenName+"Token"].methods.approve(this.$contracts.Govern.options.address,this.amount.toBN().times(10).toFixed().toWei()).send({from:this.$address}).on("transactionHash",t=>{this.tradeState="approving"}).on("receipt",async t=>{this.init(),o["a"].success(this.$t("destroyMining.text10")),this.tradeState="none"}).on("error",t=>{this.tradeState="none"})},burnBHTCastingForce(){if(this.amount<=0)return o["a"].fail(this.$t("destroyMining.text11"));if(this.balances[this.TokenName].toBN().lt(this.amount))return o["a"].fail(this.$t("destroyMining.text12"));if(!this.$web3.utils.isAddress(this.toAddress))return o["a"].fail(this.$t("destroyMining.text13"));if(this.allowances[this.TokenName].lt(this.amount))return this.approve();const t=this.$contracts.Govern.methods.burnToken(this.tokenAddress,this.amount.toWei(),this.toAddress);t.call({from:this.$address},(e,s)=>{e||t.send({from:this.$address}).on("transactionHash",t=>{this.tradeState="trading"}).on("receipt",t=>{this.init(),this.$emit("reload"),o["a"].success(this.$t("destroyMining.text14")),this.amount="",this.power=0,this.tradeState="none"}).on("error",t=>{this.tradeState="none"})})},init(){const t=new this.$web3.BatchRequest;t.add(this.$contracts.BBGToken.methods.balanceOf(this.$address).call.request({from:this.$address})),t.add(this.$contracts.BBGToken.methods.allowance(this.$address,this.$contracts.Govern.options.address).call.request({from:this.$address})),t.add(this.$contracts.USDTToken.methods.balanceOf(this.$address).call.request({from:this.$address})),t.add(this.$contracts.USDTToken.methods.allowance(this.$address,this.$contracts.Govern.options.address).call.request({from:this.$address})),t.requestManager.sendBatch(t.requests,(t,e)=>{t||(this.balances.BBG=("string"===typeof e[0]?e[0]:e[0].result).fromWei(),this.allowances.BBG=e[1].result.fromWei().toBN(),this.balances.USDT=e[2].result.fromWei(),this.allowances.USDT=e[3].result.fromWei().toBN())})}}},h=c,l=h,u=(s("4f3b"),s("2877")),m=Object(u["a"])(l,n,i,!1,null,"3c59b104",null);e["default"]=m.exports}}]);